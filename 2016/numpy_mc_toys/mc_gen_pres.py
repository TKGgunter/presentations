#from sklearn.externals import joblib
#from bokeh.io import hplot, output_file, show
#from bokeh.charts import Histogram, Scatter
#from bokeh.plotting import figure
import matplotlib.pyplot as plt
import numpy as np
import time

def mc_gen(pdf, data = []):
  t0 = time.time()
  n = 5000000
  toys = np.random.rand(n,2)


  bin_selection_array_1 = np.reshape(toys[:,0], (n, 1)) <= np.reshape(pdf[1], (1, len(pdf[1])))
  bin_selection_array_2 = np.reshape(toys[:,0], (n, 1)) >= np.reshape(pdf[1] - 1. / len(pdf[1]) , (1, len(pdf[1])))


  prob_selection_array =  np.reshape(toys[:,1], (n, 1)) <= np.reshape(pdf[0], (1, len(pdf[0])))

  results = np.where( prob_selection_array & bin_selection_array_1  & bin_selection_array_2)

  print(time.time() - t0 , len(data) )
  print( len(toys[results[0]]) )

  return data

pdf = (np.array([  0.00000000e+00,   8.95457211e-04,   0.00000000e+00,
         0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
         0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
         0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
         0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
         0.00000000e+00,   9.03307794e-04,   5.48240611e-01,
         3.75409764e-01,   9.19990285e-04,   2.89490276e-04,
         4.36688722e-05,   4.90661485e-06,   1.96264594e-06,
         1.71731520e-06,   2.70845140e-04,   4.01336562e-02,
         8.11701295e-03,   1.08365042e-02,   3.48369655e-04,
         1.01198931e-03,   9.75680363e-04,   4.17062262e-05,
         1.71731520e-05,   4.78394948e-05,   1.02548250e-04,
         4.75941641e-05,   9.32256822e-06,   2.69863817e-06,
         1.96264594e-06,   4.41595337e-06,   6.13326857e-06,
         3.43463040e-06,   1.47198446e-06,   4.90661485e-07,
         0.00000000e+00,   2.45330743e-07,   4.90661485e-07,
         2.45330743e-07,   2.45330743e-07,   0.00000000e+00,
         0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
         0.00000000e+00,   1.96264594e-06,   1.23892025e-04,
         7.01155262e-04,   2.59461793e-03,   1.11085760e-03,
         4.03814402e-04,   2.16872376e-04,   3.64806814e-04,
         4.83056232e-04,   3.42727047e-04,   3.02492806e-04,
         5.17647867e-05,   1.44745138e-05,   3.70449421e-05,
         3.09116736e-05,   8.83190674e-05,   6.50126468e-05,
         2.23250976e-05,   2.67410509e-05,   4.90661485e-06,
         3.43463040e-06,   6.37859931e-06,   4.90661485e-06,
         6.86926079e-06,   8.09591451e-06,   4.17062262e-06,
         1.96264594e-06,   7.35992228e-07,   2.45330743e-07,
         4.90661485e-07,   0.00000000e+00,   0.00000000e+00,
         2.45330743e-07,   2.45330743e-07,   4.90661485e-07,
         2.45330743e-07,   2.45330743e-07,   0.00000000e+00,
         0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
         0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
         4.28053080e-03]), np.array( [ float(i)/100 for i in range(1, 101)] ) )

#pdf = ( np.array([0.,0.,0., .25, .5, 0, 0, .33, .2, 0.]) , np.array([float(i)/10. for i in range(1,11)] ))

print("pdf", pdf)
mc_gen(pdf)


